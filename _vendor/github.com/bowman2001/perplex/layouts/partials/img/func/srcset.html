{{ $factors := (slice 1 2 3 4) }}
{{ $srcset := slice }}
{{ range $fac := $factors }}
    {{ $width := math.Round (mul $.max $fac) }}
    {{ if le $width $.img.Width }}
        {{ $img := $.img.Resize (printf "%dx" (int $width)) }}
        {{ $src := printf "%s %sx" ($img.RelPermalink | safeURL) ($fac | safeURL) | safeHTML }}
        {{ $srcset = $srcset | append $src }}
    {{ end }}
{{ end }}
{{ $srcset = delimit $srcset ", " }}
{{ return $srcset }}
