{{ if .a.link }}
  <a class="link-block"
  href="{{ .a.link | safeHTMLAttr }}"
  {{ with .a.target }}target="{{ . | safeHTMLAttr }}"{{ end }}
  {{ with $.a.rel }}rel="{{ . | safeHTMLAttr }}"{{ end }}>
{{ end }}
{{ $subType := .img.MediaType.SubType }}
{{- if eq $subType "svg" -}}
  <img class="img__svg" src="{{ .img.RelPermalink }}"
       {{ with .a.alt }}alt="{{ . }}"{{ end }}
          {{ with .a.title }}title="{{ . }}"{{ end }}>
{{- else -}}
    {{ $fallbackImg := "" }}
    {{- $imgClass := "" -}}
    {{ $fallbackWidth := site.Params.imaging.fallback_width }}
    {{ $fallbackImg = .img.Resize (printf "%dx" (int (math.Max $fallbackWidth .img.Width)) ) }}
    {{- if eq $subType "png" -}}
        {{- $imgClass = "img__png" -}}
    {{- end -}}
    <img data-src="{{ $fallbackImg.RelPermalink }}"
         data-srcset="{{ partial "img/func/generate-global-srcset.html" (dict "img" .img "a" .a ) }}"
         data-sizes="auto"
         data-aspectratio="{{ div .img.Width (float .img.Height) }}"
         data-parentfit="cover"
         src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
         class="lazyload {{ with $imgClass -}}{{ . }}{{- end }}"
            {{- with .a.alt }} alt="{{ . }}"{{ end -}}
            {{- with .a.title }} title="{{ . }}"{{ end -}}
    />
{{ end }}
{{ if .a.link }}</a>{{ end }}
